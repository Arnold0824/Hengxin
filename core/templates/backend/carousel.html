{% extends "backend/master_admin.html" %}{% block ti %}{% endblock %}
{% block linkcss %}{% endblock %}
{% load staticfiles %}
{% block body %}
    <!--主体开始-->
    <div class="main-content">
        <!--导航条开始-->
        <div class="breadcrumbs" id="breadcrumbs">
            <ul class="breadcrumb">
                <li><i class="icon-sitemap"></i><a href="/r">系统管理</a></li>
                <li class="active">轮播管理</li>
            </ul><!-- .breadcrumb -->
            <div id="nav-search" class="nav-search">
                <form class="form-search">
								<span class="input-icon">
									<input type="text" autocomplete="off" id="nav-search-input" class="nav-search-input" placeholder="Search ...">
									<i class="icon-search nav-search-icon"></i>
								</span>
                </form>
            </div>
        </div>
        <!--导航条结束-->

        <!--内容开始-->
        <div class="col-sm-11  col-md-12 col-lg-12 lefrgit">
            <h1 class="page-header">&nbsp;

            <div role="toolbar" class="btn-toolbar operation pull-right">
                        <div role="group" class="btn-group">
                            <a onclick="" class="btn btn-primary" draggable="false" data-target="#add" data-toggle="modal">新增</a>
                        </div>
                    </div>
            </h1>
            <div class="table-responsive">
                <table class="table table-striped table-hover table-bordered">
                    <thead>
                    <tr>
{#                        <th><input type="checkbox" value="" name="checkbox[]" class="input-control"></th>#}
                        {#                            <th>企业代码</th>#}
                        <th>企业名称</th>
                        {#                            <th>企业IT系统类型</th>#}
                        {#                            <th>办公地址</th>#}
                        <th>办公电话</th>
                        <th>传真</th>
                        {#                            <th>开户行</th>#}
                        {#                            <th>帐号</th>#}
                        {#                            <th>税号</th>#}
                        <th>联系人</th>
                        <th>电话</th>
                        {#                            <th>邮箱</th>#}
                        <th>财务负责人</th>
                        <th>联系电话</th>
                        {#                            <th>管理员</th>#}
                        {#                            <th>管理员电话</th>#}
                        {#                            <th>管理邮箱</th>#}
                        <th>登记日期</th>
                        <th>更多</th>

                        {#                            <th>备注</th>#}
                    </tr>
                    </thead>
                    <tbody>
                    {% if CPNs != None %}
                        {% for cpn in CPNs %}
                            <tr>
{#                                <td><input type="checkbox" value="" name="checkbox[]" class="input-control"></td>#}
                                {#                            <td class="article-title">1001</td>#}
                                <td>{{ cpn.Name }}</td>
                                {#                            <td>成都市二环路东二段</td>#}
                                {#                            <td>028-85689568</td>#}
                                <td>{{ cpn.Tel }}</td>
                                <td>{{ cpn.Fax }}</td>
                                {#                            <td>成都银行</td>#}

                                {#                            <td>6525956865214587</td>#}
                                <td>{{ cpn.Lnkr }}</td>
                                <td>{{ cpn.LnkPhn }}</td>
                                {#                            <td>18888888@qq.com</td>#}
                                <td>{{ cpn.Cfo }}</td>
                                <td>{{ cpn.CfoPhn }}</td>

                                <td>{{ cpn.OpnDt }}</td>
                                <td><a class="btn btn-primary btn-xs btn-github" data-target="#update_{{ cpn.id }}" data-toggle="modal" href="">查看详情</a></td>

                            </tr>
                        {% endfor %}
                    {% endif %}
                    </tbody>
                </table>
            </div>
            {% if CPNs != None %}
                {% for cpn in CPNs %}
                    <div aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="update_{{ cpn.id }}" class="modal fade">
                        <div role="document" class="modal-dialog">

                            <div class="modal-content">
                                <div class="modal-header">
                                    <button aria-label="Close" data-dismiss="modal" class="close" type="button"><span aria-hidden="true">×</span></button>
                                    <h4 id="myModalLabel" class="modal-title">企业注册详情</h4>
                                </div>

                                <div class="modal-body">
                                    <form class="form-horizontal" method="POST" action="/admin/cpn">

                                        <div class="form-group">
                                            <label class="control-label col-xs-12 col-sm-2 no-padding-right">企业名称:</label>
                                            <div class="col-xs-12 col-sm-12">
                                                <div class="clearfix"><input type="text" name="name" value="{{ cpn.Name }}" class="col-xs-12 col-sm-12"></div>
                                                <input type="hidden" name="id" value="{{ cpn.id }}">
                                            </div>

                                        </div>

                                        <div class="space-2"></div>
                                        <div class="form-group">
                                            <label class="control-label col-xs-12 col-sm-2 no-padding-right">办公地址:</label>
                                            <div class="col-xs-12 col-sm-12">
                                                <div class="clearfix"><input type="text" name="adr" value="{{ cpn.Adr }}" class="col-xs-12 col-sm-12"></div>
                                            </div>


                                        </div>
                                        <div class="space-2"></div>
                                        <div class="form-group">
                                            <label class="control-label col-xs-12 col-sm-2 no-padding-right">办公电话:</label>
                                            <div class="col-xs-12 col-sm-3">
                                                <div class="clearfix"><input type="text" name="tel" value="{{ cpn.Tel }}" class="col-xs-12 col-sm-12"></div>
                                            </div>
                                            <label class="control-label col-xs-12 col-sm-3 no-padding-right">企业IT系统类型:</label>
                                            <div class="col-xs-12 col-sm-3">
                                                <div class="clearfix"><input type="text" name="cpnittp" value="{{ cpn.Cpnittp }}" class="col-xs-12 col-sm-12"></div>
                                            </div>
                                        </div>
                                        <div class="space-2"></div>
                                        <div class="form-group">
                                            <label class="control-label col-xs-12 col-sm-2 no-padding-right">城市:</label>
                                            <div class="col-xs-12 col-sm-3">
                                                <div class="clearfix"><input type="text" name="city" value="{{ cpn.City }}" class="col-xs-12 col-sm-12"></div>
                                            </div>
                                            <label class="control-label col-xs-12 col-sm-3 no-padding-right">传真:</label>
                                            <div class="col-xs-12 col-sm-3">
                                                <div class="clearfix"><input type="text" name="fax" value="{{ cpn.Fax }}" class="col-xs-12 col-sm-12"></div>
                                            </div>
                                        </div>

                                        <div class="space-2"></div>
                                        <div class="form-group">
                                            <label class="control-label col-xs-12 col-sm-2 no-padding-right">开户行:</label>
                                            <div class="col-xs-12 col-sm-3">
                                                <div class="clearfix"><input type="text" name="opnbnk" value="{{ cpn.OpnBnk }}" class="col-xs-12 col-sm-12"></div>
                                            </div>
                                            <label class="control-label col-xs-12 col-sm-3 no-padding-right">帐号:</label>
                                            <div class="col-xs-12 col-sm-3">
                                                <div class="clearfix"><input type="text" name="actno" value="{{ cpn.actno }}" class="col-xs-12 col-sm-12"></div>
                                            </div>
                                        </div>
                                        <div class="space-2"></div>
                                        <div class="form-group">
                                            <label class="control-label col-xs-12 col-sm-2 no-padding-right">税号:</label>
                                            <div class="col-xs-12 col-sm-3">
                                                <div class="clearfix">
                                                    <input type="text" class="col-xs-12 col-sm-12" value="{{ cpn.TaxID }}" name="taxid" />
                                                </div>
                                            </div>
                                            <label class="control-label col-xs-12 col-sm-3 no-padding-right">联系人:</label>
                                            <div class="col-xs-12 col-sm-3">
                                                <div class="clearfix"><input type="text" class="col-xs-12 col-sm-12" value="{{ cpn.Lnkr }}" name="lnkr"></div>
                                            </div>
                                        </div>

                                        <div class="space-2"></div>
                                        <div class="form-group">
                                            <label class="control-label col-xs-12 col-sm-2 no-padding-right">联系人电话:</label>
                                            <div class="col-xs-12 col-sm-3">
                                                <div class="clearfix"><input type="text" class="col-xs-12 col-sm-12" value="{{ cpn.LnkPhn }}" name="lnkphn"/></div>
                                            </div>
                                            <label class="control-label col-xs-12 col-sm-3 no-padding-right">联系人邮箱:</label>
                                            <div class="col-xs-12 col-sm-3">
                                                <div class="clearfix">
                                                    <input type="text" class="col-xs-12 col-sm-12" name="lnkeml" value="{{ cpn.LnkEml }}">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="space-2"></div>
                                        <div class="form-group">
                                            <label class="control-label col-xs-12 col-sm-2 no-padding-right">财务负责人:</label>
                                            <div class="col-xs-12 col-sm-3">
                                                <div class="clearfix">
                                                    <input type="text" class="col-xs-12 col-sm-12" name="cfo" value="{{ cpn.Cfo }}">
                                                </div>
                                            </div>
                                            <label class="control-label col-xs-12 col-sm-3 no-padding-right">财务联系电话:</label>
                                            <div class="col-xs-12 col-sm-3">
                                                <div class="clearfix"><input type="text" class="col-xs-12 col-sm-12" name="cfophn" value="{{ cpn.CfoPhn }}"></div>
                                            </div>
                                        </div>

                                        <div class="space-2"></div>
                                        <div class="form-group">
                                            <label class="control-label col-xs-12 col-sm-2 no-padding-right">管理员:</label>
                                            <div class="col-xs-12 col-sm-3">
                                                <div class="clearfix"><input type="text" class="col-xs-12 col-sm-12" name="cio" value="{{ cpn.Cio }}"></div>
                                            </div>
                                            <label class="control-label col-xs-12 col-sm-3 no-padding-right">管理员电话:</label>
                                            <div class="col-xs-12 col-sm-3">
                                                <div class="clearfix"><input type="text" class="col-xs-12 col-sm-12" name="ciophn" value="{{ cpn.CioPhn }}"></div>
                                            </div>
                                        </div><div class="space-2"></div>
                                        <div class="form-group">
                                            <label class="control-label col-xs-12 col-sm-2 no-padding-right">管理邮箱:</label>
                                            <div class="col-xs-12 col-sm-3">
                                                <div class="clearfix"><input type="text" class="col-xs-12 col-sm-12" name="cioeml" value="{{ cpn.CioEml }}"></div>
                                            </div>
                                        </div>

                                </div>
                                <div class="modal-footer">
                                    <button data-dismiss="modal" class="btn btn-default" type="button">关闭</button>
                                    <button class="btn btn-primary" type="submit">保存</button>
                                </div>
</form>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            {% endif %}


            <div aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="add" class="modal fade">
                <div role="document" class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button aria-label="Close" data-dismiss="modal" class="close" type="button"><span aria-hidden="true">×</span></button>
                            <h4 id="myModalLabel" class="modal-title">新增轮播项</h4>
                        </div>
                        <div class="modal-body">
                            <form class="form-horizontal" method="post" id="addform" action="/r/addcarousel" enctype="multipart/form-data">
{% csrf_token %}
                                <div class="form-group">
                                    <label class="control-label col-xs-2 col-sm-2 no-padding-right">轮播标题:</label>
                                    <div class="col-xs-9 col-sm-9">
                                        <div class="clearfix"><input type="text" name="title" class="col-xs-12 col-sm-12"></div>
                                    </div>

                                </div>

                                <div class="space-2"></div>
                                <div class="form-group">
                                    <label class="control-label col-xs-2 col-sm-2 no-padding-right">轮播文字:</label>
                                    <div class="col-xs-9 col-sm-9">
                                        <div class="clearfix"><input type="text" name="caption" class="col-xs-12 col-sm-12"></div>
                                    </div>


                                </div>
<div class="space-2"></div>
                                <div class="form-group">
                                <label class="control-label col-xs-2 col-sm-2 no-padding-right">链接地址:</label>
                                    <div class="col-xs-9 col-sm-9">
                                        <div class="clearfix"><input type="text" name="link" placeholder="(http://www.xxx.com/xxx)" class="col-xs-12 col-sm-12"></div>
                                    </div>
                                    </div>
                                <div class="form-group">
															<div class="col-xs-12">
																<input type="file" name="img" id="id-input-file-2" />
															</div>
														</div>

                        <div class="modal-footer">
                            <button data-dismiss="modal" class="btn btn-default" type="button">关闭</button>
                            <input type="button" onclick="su()" class="btn btn-primary" value="保存"/>
                        </div>
                                <script>

                                    function su() {


                                    NProgress.start();
                var formData = new FormData($( "#addform" )[0]);
                $.ajax({
                    url: "/r/addcarousel",
                    type: "POST",
                    data: formData,
                    /**
                    *必须false才会自动加上正确的Content-Type
                    */
                    enctype:"multipart/form-data",
                    contentType: false,
                    /**
                    * 必须false才会避开jQuery对 formdata 的默认处理
                    * XMLHttpRequest会对 formdata 进行正确的处理
                    */
                    processData: false,
                    success: function (data) {
                        data=JSON.parse(data)
                        if (data.status == "200") {
                            alert("上传成功！");
                        }
                        if (data.status == "500") {
                            alert(data.msg);
                        }
                        NProgress.done();
                    },
                    error: function () {
                        alert("上传失败！");
                        NProgress.done();
                    }
                });

}</script>
                        </form>
                    </div>
                </div>
            </div>


        </div>
        <!--内容结束-->

    </div>
    <script>
    $('#li_carousel').attr('class','active');
$('#id-input-file-2').ace_file_input({
					no_file:'无文件 ...',
					btn_choose:'选择',
					btn_change:'重选',
					droppable:false,
					onchange:null,
					thumbnail:false //| true | large
					//whitelist:'gif|png|jpg|jpeg'
					//blacklist:'exe|php'
					//onchange:''
					//
				});
    </script>
    <!--主体结束-->
{% endblock %}